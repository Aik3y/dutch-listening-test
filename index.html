
<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Luistertoets - Opdrachten</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; background: #f5f5f5; border-radius: 10px; }
    h1 { text-align: center; }
    label { display: block; margin-top: 20px; font-weight: bold; }
    input[type="text"] { width: 100%; padding: 10px; margin-top: 8px; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
    #feedback { margin-top: 30px; background: #fff; padding: 20px; border-radius: 10px; }
  </style>
  <script src="opdrachten.js"></script>
</head>
<body>
  <h1>Luistertoets - Opdrachten</h1>
  <p>Luister naar de audio en beantwoord de drie vragen.</p>

  <audio id="audio-player" controls>
    <source id="audio-source" src="" type="audio/mpeg">
    Je browser ondersteunt geen audio.
  </audio>

  <form id="quiz-form">
    <div id="questions-container"></div>
    <button type="submit">Verstuur</button>
  </form>

  <div id="feedback"></div>
  <button id="next-button" style="display:none;">Volgende opdracht</button>

  <script>
    let stats = {};
    opdrachten.forEach((_, index) => {
      stats[index] = { fouten: 0, juist: 0 };
    });

    function kiesOpdrachtIndex() {
      const gewichten = opdrachten.map((_, i) => 1 + stats[i].fouten * 2);
      const totaal = gewichten.reduce((a, b) => a + b, 0);
      let keuze = Math.random() * totaal;

      for (let i = 0; i < gewichten.length; i++) {
        if (keuze < gewichten[i]) return i;
        keuze -= gewichten[i];
      }
      return 0;
    }

    let currentIndex = kiesOpdrachtIndex();

    function laadOpdracht(index) {
      const opdracht = opdrachten[index];
      const audioSource = document.getElementById('audio-source');
      const audioPlayer = document.getElementById('audio-player');
      const container = document.getElementById('questions-container');
      const feedbackDiv = document.getElementById('feedback');

      audioSource.src = opdracht.audio;
      audioPlayer.load();

      container.innerHTML = '';
      feedbackDiv.innerHTML = '';
      document.getElementById('next-button').style.display = 'none';

      opdracht.vragen.forEach((item, index) => {
        const label = document.createElement('label');
        label.textContent = `${index + 1}. ${item.vraag}`;
        label.setAttribute('for', `vraag${index}`);

        const input = document.createElement('input');
        input.type = 'text';
        input.id = `vraag${index}`;
        input.name = `vraag${index}`;
        input.required = true;

        container.appendChild(label);
        container.appendChild(input);
      });
    }

    document.getElementById('quiz-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const opdracht = opdrachten[currentIndex];
      let feedback = "<h2>Feedback:</h2>";
      let fouten = 0;

      opdracht.vragen.forEach((item, index) => {
        const userAnswer = document.getElementById(`vraag${index}`).value.trim().toLowerCase();
        const correct = item.antwoord.toLowerCase();

        if (userAnswer.includes(correct)) {
          feedback += `<p>✅ Vraag ${index + 1} is correct!</p>`;
          stats[currentIndex].juist++;
        } else {
          feedback += `<p>❌ Vraag ${index + 1} is niet correct. Juist antwoord: ${item.antwoord}</p>`;
          fouten++;
        }
      });

      stats[currentIndex].fouten += fouten;
      document.getElementById('feedback').innerHTML = feedback;
      document.getElementById('next-button').style.display = 'block';
    });

    document.getElementById('next-button').addEventListener('click', function () {
      currentIndex = kiesOpdrachtIndex();
      laadOpdracht(currentIndex);
    });

    // Start
    laadOpdracht(currentIndex);
  </script>
</body>
</html>
